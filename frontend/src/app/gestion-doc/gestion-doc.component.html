<div class="container">
  <h1 class="title">
    <i class="fas fa-folder-open"></i> Gestionnaire de documents
  </h1>
  <h2 class="subtitle">
    <i class="fas fa-file-upload"></i> Importer la liste des documents
  </h2>

  <!-- Zone de dépôt de fichiers -->
  <div
    class="dropzone"
    (drop)="onFileDropped($event)"
    (dragover)="preventDefault($event)"
    (click)="triggerFileInput()"
  >
    <i class="fas fa-cloud-upload-alt"></i> Glissez et déposez vos fichiers ici
    ou cliquez pour les ajouter.
  </div>

  <!-- Input de sélection de fichiers -->
  <input
    type="file"
    id="fileInput"
    multiple
    style="display: none"
    (change)="onFileSelected($event)"
  />

  <!-- Bouton pour télécharger les fichiers -->

  <!-- Message informatif sur les permissions -->
  <div class="mt-3 alert alert-info">
    <p>{{ message }}</p>
  </div>

  <!-- Télécharger le PDF si l'utilisateur a le rôle -->
  <button
    *ngIf="hasPdfRole"
    class="btn btn-secondary mt-3"
    (click)="downloadPdf()"
  >
    <i class="fas fa-file-pdf"></i> Télécharger PDF
  </button>

  <!-- Bouton désactivé pour les utilisateurs sans rôle PDF -->
  <button *ngIf="!hasPdfRole" class="btn btn-secondary mt-3" [disabled]="true">
    <i class="fas fa-file-pdf"></i> Vous n'avez pas la permission de télécharger
    PDF
  </button>

  <!-- Télécharger le CSV si l'utilisateur a le rôle -->
  <button
    *ngIf="hasCsvRole"
    class="btn btn-secondary mt-3"
    (click)="downloadCsv()"
  >
    <i class="fas fa-file-csv"></i> Télécharger CSV
  </button>

  <!-- Bouton désactivé pour les utilisateurs sans rôle CSV -->
  <button *ngIf="!hasCsvRole" class="btn btn-secondary mt-3" [disabled]="true">
    <i class="fas fa-file-csv"></i> Vous n'avez pas la permission de télécharger
    CSV
  </button>

  <!-- Section des fichiers importés -->
  <div class="file-imported-section mt-4">
    <h3><i class="fas fa-file-import"></i> Fichiers importés :</h3>
    <div *ngIf="uploadedFiles.length > 0; else noFiles">
      <ul class="uploaded-files-list">
        <li *ngFor="let file of uploadedFiles" class="uploaded-file-item">
          <i
            class="fas"
            [ngClass]="{
              'fa-file-pdf': file.type === 'application/pdf',
              'fa-file-csv': file.type === 'text/csv',
              'fa-file-alt':
                file.type !== 'application/pdf' && file.type !== 'text/csv'
            }"
          ></i>
          <span>{{ file.name }}</span>
        </li>
      </ul>
    </div>
    <ng-template #noFiles>
      <p class="no-files">
        <i class="fas fa-folder-open"></i> Aucun fichier choisi.
      </p>
    </ng-template>
  </div>

  <!-- Popup -->
  <div class="popup" *ngIf="showPopup">
    <i
      class="fas"
      [ngClass]="{
        'fa-check-circle': popupMessage.includes('succès'),
        'fa-exclamation-triangle': popupMessage.includes('erreur'),
        'fa-info-circle': popupMessage.includes('info')
      }"
    ></i>
    {{ popupMessage }}
  </div>
</div>
